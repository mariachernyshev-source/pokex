# PATH: lesson_map_canvas.md
# WHAT: –£—Ä–æ–∫ –ø–æ "–∂–∏–≤–æ–π" –∫–∞—Ä—Ç–µ –Ω–∞ —Ö–æ–ª—Å—Ç–µ (canvas) –¥–ª—è –ø–æ–∫–µ–º–æ–Ω—Å–∫–æ–≥–æ –º–∏—Ä–∞
# WHY:  –ù–∞—É—á–∏—Ç—å—Å—è –¥–µ–ª–∞—Ç—å –∫–∞—Ä—Ç—É, –∫–æ—Ç–æ—Ä—É—é –º–æ–∂–Ω–æ –¥–≤–∏–≥–∞—Ç—å, –ø—Ä–∏–±–ª–∏–∂–∞—Ç—å –∏ –Ω–∞ –∫–æ—Ç–æ—Ä–æ–π –ø–æ—è–≤–ª—è—é—Ç—Å—è –ø–æ–∫–µ–º–æ–Ω—ã –ø–æ –∫–ª–∏–∫—É
# RELEVANT: map.html, map.js, images/map.png, images/pikachu-icon.png

# –£—Ä–æ–∫ ‚Ññ6 ‚Äî –ñ–∏–≤–∞—è –∫–∞—Ä—Ç–∞ –ø–æ–∫–µ–º–æ–Ω—Å–∫–æ–≥–æ –º–∏—Ä–∞ –Ω–∞ —Ö–æ–ª—Å—Ç–µ

–ü—Ä–∏–≤–µ—Ç! –í –ø—Ä–æ—à–ª–æ–º —É—Ä–æ–∫–µ –º—ã —Å–¥–µ–ª–∞–ª–∏ **–ø—Ä–æ—Å—Ç—É—é –∫–∞—Ä—Ç—É** —Å –∫–∞—Ä—Ç–∏–Ω–∫–æ–π, –∑–Ω–∞—á–∫–∞–º–∏ –∏ –∫–Ω–æ–ø–∫–∞–º–∏ –ø—Ä–∏–±–ª–∏–∂–µ–Ω–∏—è.
–¢–µ–ø–µ—Ä—å –ø–æ—Ä–∞ –≤—ã–ø–æ–ª–Ω–∏—Ç—å –ú–∞—à–∏–Ω—É –º–µ—á—Ç—É ‚Äî —Å–¥–µ–ª–∞—Ç—å **–Ω–∞—Å—Ç–æ—è—â—É—é –∂–∏–≤—É—é –∫–∞—Ä—Ç—É**, –∫–∞–∫ –≤ –∏–≥—Ä–µ:

> –í –Ω–∞—á–∞–ª–µ, –∫–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –∫–∞—Ä—Ç—É,
> –æ–Ω –≤–∏–¥–∏—Ç –∫–∞—Ä—Ç–∏–Ω–∫—É. –î–≤–∏–∂–µ–Ω–∏–µ–º –º—ã—à–∫–∏ –æ–Ω –ø—Ä–∏–±–ª–∏–∂–∞–µ—Ç, –æ—Ç–¥–∞–ª—è–µ—Ç –∏ –¥–≤–∏–≥–∞–µ—Ç –µ—ë –≤–ø—Ä–∞–≤–æ‚Äë–≤–ª–µ–≤–æ.
> –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –ø—Ä–∏–±–ª–∏–∑–∏—Ç—å –∫–∞—Ä—Ç—É –¥–æ –º–∞–ª—é—Å–µ–Ω—å–∫–æ–≥–æ —Ö–æ–ª–º–∏–∫–∞.
> –ö–æ–≥–¥–∞ –æ–Ω –Ω–∞–∂–∏–º–∞–µ—Ç –Ω–∞ —Ö–æ–ª–º–∏–∫, —Å–∫–∞–ª—É –∏–ª–∏ –ø—Ä—É–¥ ‚Äî —Ç–∞–º –ø–æ—è–≤–ª—è–µ—Ç—Å—è –ø–æ–∫–µ–º–æ–Ω.
> –í —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑, –∫–æ–≥–¥–∞ –æ–Ω –Ω–∞–∂–∏–º–∞–µ—Ç –Ω–∞ –ø–æ–∫–µ–º–æ–Ω–∞ ‚Äî –æ–Ω –∏—Å—á–µ–∑–∞–µ—Ç.
> –ü—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –≤—Å–µ –ø–æ–∫–µ–º–æ–Ω—ã –∏ –ø—Ä–∏–±–ª–∏–∂–µ–Ω–∏–µ –æ—Å—Ç–∞—é—Ç—Å—è –Ω–∞ –º–µ—Å—Ç–µ.

–ú—ã —Å–¥–µ–ª–∞–µ–º –≤—Å—ë —ç—Ç–æ **–Ω–∞ —Ö–æ–ª—Å—Ç–µ** ‚Äî —Å –ø–æ–º–æ—â—å—é —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞ HTML: `<canvas>`.

---

## 0. –ß—Ç–æ –º—ã –±—É–¥–µ–º –¥–µ–ª–∞—Ç—å –≤ —ç—Ç–æ–º —É—Ä–æ–∫–µ

–í –∫–æ–Ω—Ü–µ —É—Ä–æ–∫–∞ —É —Ç–µ–±—è –±—É–¥–µ—Ç:

- —Å—Ç—Ä–∞–Ω–∏—Ü–∞ `map.html` —Å **—Ö–æ–ª—Å—Ç–æ–º** (`<canvas>`);
- –∫–∞—Ä—Ç–∞, –∫–æ—Ç–æ—Ä—É—é –º–æ–∂–Ω–æ **–¥–≤–∏–≥–∞—Ç—å –º—ã—à–∫–æ–π** –∏ **–ø—Ä–∏–±–ª–∏–∂–∞—Ç—å/–æ—Ç–¥–∞–ª—è—Ç—å –∫–æ–ª–µ—Å–∏–∫–æ–º**;
- **–º–µ—Å—Ç–∞ –Ω–∞ –∫–∞—Ä—Ç–µ** (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Ö–æ–ª–º–∏–∫, —Å–∫–∞–ª–∞, –ø—Ä—É–¥);
- –ø—Ä–∏ –∫–ª–∏–∫–µ –ø–æ –º–µ—Å—Ç—É ‚Äî –ø–æ—è–≤–ª—è–µ—Ç—Å—è –∑–Ω–∞—á–æ–∫ –ø–æ–∫–µ–º–æ–Ω–∞;
- –ø—Ä–∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–º –∫–ª–∏–∫–µ –ø–æ –ø–æ–∫–µ–º–æ–Ω—É ‚Äî –æ–Ω –∏—Å—á–µ–∑–∞–µ—Ç;
- –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã **–≤—Å—ë –∑–∞–ø–æ–º–∏–Ω–∞–µ—Ç—Å—è** (–º–∞—Å—à—Ç–∞–±, —Å–¥–≤–∏–≥ –∏ –∫–∞–∫–∏–µ –ø–æ–∫–µ–º–æ–Ω—ã –≤–∏–¥–Ω—ã).

–ß–∞—Å—Ç—å –∫–æ–¥–∞ –±—É–¥–µ—Ç —É–∂–µ "—á—É—Ç—å –≤–∑—Ä–æ—Å–ª–∞—è". –ù–æ—Ä–º–∞–ª—å–Ω–æ, –µ—Å–ª–∏ —Ç—ã –∫–∞–∫–∏–µ‚Äë—Ç–æ –∫—É—Å–∫–∏ –ø—Ä–æ—Å—Ç–æ **–∞–∫–∫—É—Ä–∞—Ç–Ω–æ –∫–æ–ø–∏—Ä—É–µ—à—å**, –∞ –ø–∞–ø–∞ –ø–æ–º–æ–≥–∞–µ—Ç –ø–æ–Ω—è—Ç—å, —á—Ç–æ –∫ —á–µ–º—É.

---

## 1. –ú–µ–Ω—è–µ–º –∫–∞—Ä—Ç—É –Ω–∞ —Ö–æ–ª—Å—Ç (canvas)

–°–Ω–∞—á–∞–ª–∞ –ø—Ä–µ–≤—Ä–∞—Ç–∏–º –æ–±—ã—á–Ω—É—é –∫–∞—Ä—Ç–∏–Ω–∫—É –∫–∞—Ä—Ç—ã –≤ **—Ö–æ–ª—Å—Ç**, –Ω–∞ –∫–æ—Ç–æ—Ä–æ–º –º—ã –±—É–¥–µ–º —Ä–∏—Å–æ–≤–∞—Ç—å.

### –®–∞–≥ 1: –û—Ç–∫—Ä—ã–≤–∞–µ–º `map.html`

1. –í CodeEdit **–æ—Ç–∫—Ä–æ–π** —Ñ–∞–π–ª `map.html` –∏–∑ –ø–∞–ø–∫–∏ –ø—Ä–æ–µ–∫—Ç–∞.
2. –ù–∞–π–¥–∏ –±–ª–æ–∫ —Å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–º –∫–∞—Ä—Ç—ã. –í –ø—Ä–æ—à–ª–æ–º —É—Ä–æ–∫–µ –æ–Ω –≤—ã–≥–ª—è–¥–µ–ª –ø—Ä–∏–º–µ—Ä–Ω–æ —Ç–∞–∫:

```html
<div id="map-container">
  <img id="map" src="images/map.png" alt="–∫–∞—Ä—Ç–∞ –ø–æ–∫–µ–º–æ–Ω—Å–∫–æ–≥–æ –º–∏—Ä–∞">
</div>
```

### –®–∞–≥ 2: –ó–∞–º–µ–Ω—è–µ–º –∫–∞—Ä—Ç–∏–Ω–∫—É –Ω–∞ `<canvas>`

–ù–∞–º –Ω—É–∂–µ–Ω —Ö–æ–ª—Å—Ç, –ø–æ—ç—Ç–æ–º—É –∑–∞–º–µ–Ω–∏–º `<img>` –Ω–∞ `<canvas>`:

```html
<div id="map-container">
  <canvas id="map-canvas" width="1200" height="800"></canvas>
</div>
```

–û–±—Ä–∞—Ç–∏ –≤–Ω–∏–º–∞–Ω–∏–µ:
- `canvas` ‚Äî —ç—Ç–æ —Ç–µ–≥‚Äë—Ö–æ–ª—Å—Ç;
- `id="map-canvas"` ‚Äî –∏–º—è, –ø–æ –∫–æ—Ç–æ—Ä–æ–º—É –º—ã –Ω–∞–π–¥—ë–º —Ö–æ–ª—Å—Ç –≤ JS;
- `width` –∏ `height` ‚Äî —Ä–∞–∑–º–µ—Ä —Ö–æ–ª—Å—Ç–∞ –≤ –ø–∏–∫—Å–µ–ª—è—Ö. –ú–æ–∂–Ω–æ –ø–æ–¥–ø—Ä–∞–≤–∏—Ç—å –ø–æ–¥ —Å–≤–æ—é –∫–∞—Ä—Ç—É.

### –®–∞–≥ 3: –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —Å–∫—Ä–∏–ø—Ç–∞

–í–Ω–∏–∑—É —Ñ–∞–π–ª–∞ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –ø–æ–¥–∫–ª—é—á—ë–Ω `map.js`:

```html
<script src="map.js" defer></script>
```

–ï—Å–ª–∏ —ç—Ç–æ–π —Å—Ç—Ä–æ–∫–∏ –≤–¥—Ä—É–≥ –Ω–µ—Ç ‚Äî **–¥–æ–±–∞–≤—å –µ—ë –ø–µ—Ä–µ–¥ `</body>`**.

–°–æ—Ö—Ä–∞–Ω–∏ `map.html` (`‚åòS`).

---

## 2. –ì–æ—Ç–æ–≤–∏–º —Å—Ç–∏–ª–∏ –¥–ª—è —Ö–æ–ª—Å—Ç–∞

–û—Ç–∫—Ä–æ–π `style.css` –∏ –≤–Ω–∏–∑—É **—É–±–µ—Ä–∏/–∑–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–π** —Å—Ç–∞—Ä–æ–µ –ø—Ä–∞–≤–∏–ª–æ –¥–ª—è `#map` (–µ—Å–ª–∏ —Ç–∞–º –µ—Å—Ç—å `#map { ... }`).
–í–º–µ—Å—Ç–æ –Ω–µ–≥–æ –¥–æ–±–∞–≤–∏–º —Å—Ç–∏–ª–∏ –¥–ª—è —Ö–æ–ª—Å—Ç–∞:

```css
/* –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –∫–∞—Ä—Ç—ã –æ—Å—Ç–∞—ë—Ç—Å—è –∫–∞–∫ –±—ã–ª –≤ –ø—Ä–æ—à–ª–æ–º —É—Ä–æ–∫–µ */
#map-container {
  position: relative;
  width: 100%;
  max-width: 900px;
  margin: 20px auto;
  border: 3px solid #aaa;
  border-radius: 12px;
  overflow: hidden;
  background: #000; /* —Ñ–æ–Ω –≤–æ–∫—Ä—É–≥ –∫–∞—Ä—Ç—ã –Ω–∞ –≤—Å—è–∫–∏–π —Å–ª—É—á–∞–π */
}

/* –•–æ–ª—Å—Ç –∫–∞—Ä—Ç—ã */
#map-canvas {
  display: block;
  width: 100%;  /* —Ä–∞—Å—Ç—è–≥–∏–≤–∞–µ–º –ø–æ —à–∏—Ä–∏–Ω–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ */
  height: auto;
  background: #000; /* –ø–æ–∫–∞ –∫–∞—Ä—Ç–∞ –Ω–µ –∑–∞–≥—Ä—É–∑–∏–ª–∞—Å—å */
  cursor: grab;
}
```

**–¢–µ—Ä–º–∏–Ω—ã –ø–æ‚Äë–ø—Ä–æ—Å—Ç–æ–º—É:**

- **canvas / —Ö–æ–ª—Å—Ç** ‚Äî –∫–∞–∫ –ª–∏—Å—Ç –±—É–º–∞–≥–∏, –Ω–∞ –∫–æ—Ç–æ—Ä—ã–π –º—ã –º–æ–∂–µ–º —Ä–∏—Å–æ–≤–∞—Ç—å —Å –ø–æ–º–æ—â—å—é JS;
- `cursor: grab` ‚Äî –∫—É—Ä—Å–æ—Ä‚Äë—Ä—É–∫–∞, –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, —á—Ç–æ –∫–∞—Ä—Ç—É –º–æ–∂–Ω–æ –¥–≤–∏–≥–∞—Ç—å;
- `overflow: hidden` ‚Äî –≤—Å—ë, —á—Ç–æ –≤—ã–ª–µ–∑–µ—Ç –∑–∞ —Ä–∞–º–∫—É ‚Äî –±—É–¥–µ—Ç —Å–ø—Ä—è—Ç–∞–Ω–æ.

–°–æ—Ö—Ä–∞–Ω–∏ `style.css`.

---

## 3. –ó–∞–≥—Ä—É–∂–∞–µ–º –∫–∞—Ä—Ç—É –Ω–∞ —Ö–æ–ª—Å—Ç –≤ `map.js`

–¢–µ–ø–µ—Ä—å –º—ã –Ω–∞—É—á–∏–º JS **—Ä–∏—Å–æ–≤–∞—Ç—å –∫–∞—Ä—Ç–∏–Ω–∫—É –∫–∞—Ä—Ç—ã –Ω–∞ —Ö–æ–ª—Å—Ç–µ**.

### –®–∞–≥ 1: –û—Ç–∫—Ä—ã–≤–∞–µ–º `map.js`

1. –í CodeEdit **–æ—Ç–∫—Ä–æ–π** —Ñ–∞–π–ª `map.js`.
2. –ß—Ç–æ–±—ã –Ω–µ –ø—É—Ç–∞—Ç—å—Å—è, –¥–∞–≤–∞–π **–∑–∞–º–µ–Ω–∏–º –≤–µ—Å—å —Å—Ç–∞—Ä—ã–π –∫–æ–¥** –Ω–∞ –Ω–æ–≤—ã–π (—Å–∫–æ–ø–∏—Ä—É–π –±–ª–æ–∫ –Ω–∏–∂–µ —Ü–µ–ª–∏–∫–æ–º).

```javascript
// 1. –ù–∞—Ö–æ–¥–∏–º —Ö–æ–ª—Å—Ç –∏ –ø–æ–ª—É—á–∞–µ–º "–∫–∏—Å—Ç—å" (–∫–æ–Ω—Ç–µ–∫—Å—Ç)
const canvas = document.getElementById('map-canvas');
const ctx = canvas.getContext('2d');

// 2. –ó–∞–≥—Ä—É–∂–∞–µ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∫–∞—Ä—Ç—ã
const mapImage = new Image();
mapImage.src = 'images/map.png';

// –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∫–∞–º–µ—Ä—ã (–∫–∞–∫ –º—ã —Å–º–æ—Ç—Ä–∏–º –Ω–∞ –∫–∞—Ä—Ç—É)
let scale = 1;        // –º–∞—Å—à—Ç–∞–± (1 = –æ–±—ã—á–Ω—ã–π —Ä–∞–∑–º–µ—Ä)
let offsetX = 0;      // —Å–¥–≤–∏–≥ –ø–æ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª–∏
let offsetY = 0;      // —Å–¥–≤–∏–≥ –ø–æ –≤–µ—Ä—Ç–∏–∫–∞–ª–∏

// –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –ø–æ –∑—É–º—É
const MIN_SCALE = 0.4;
const MAX_SCALE = 4;

// –ö–æ–≥–¥–∞ –∫–∞—Ä—Ç–∏–Ω–∫–∞ –∫–∞—Ä—Ç—ã –∑–∞–≥—Ä—É–∑–∏—Ç—Å—è ‚Äî –Ω–∞—Ä–∏—Å—É–µ–º –µ—ë
mapImage.onload = function () {
  drawScene();
};

// –§—É–Ω–∫—Ü–∏—è, –∫–æ—Ç–æ—Ä–∞—è —Ä–∏—Å—É–µ—Ç –∫–∞—Ä—Ç—É –∏ –≤—Å—ë, —á—Ç–æ –Ω–∞ –Ω–µ–π
function drawScene() {
  // –ß–∏—Å—Ç–∏–º —Ö–æ–ª—Å—Ç
  ctx.clearRect(0, 0, canvas.width, canvas.height);

  // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ "–∫–∏—Å—Ç–∏"
  ctx.save();

  // –ü—Ä–∏–º–µ–Ω—è–µ–º –º–∞—Å—à—Ç–∞–± –∏ —Å–¥–≤–∏–≥
  ctx.translate(offsetX, offsetY);
  ctx.scale(scale, scale);

  // –†–∏—Å—É–µ–º –∫–∞—Ä—Ç—É –≤ —Ç–æ—á–∫–µ (0, 0)
  ctx.drawImage(mapImage, 0, 0);

  // –ó–¥–µ—Å—å –ø–æ–∑–∂–µ –±—É–¥–µ–º —Ä–∏—Å–æ–≤–∞—Ç—å –ø–æ–∫–µ–º–æ–Ω–æ–≤

  // –í–æ–∑–≤—Ä–∞—â–∞–µ–º—Å—è –∫ –æ–±—ã—á–Ω–æ–º—É —Å–æ—Å—Ç–æ—è–Ω–∏—é
  ctx.restore();
}
```

**–ü–æ—è—Å–Ω–µ–Ω–∏—è —á–µ–ª–æ–≤–µ—á–µ—Å–∫–∏–º —è–∑—ã–∫–æ–º:**

- `getContext('2d')` ‚Äî –ø—Ä–æ—Å–∏–º —É —Ö–æ–ª—Å—Ç–∞ "–∫–∏—Å—Ç—å", –∫–æ—Ç–æ—Ä–æ–π –º–æ–∂–Ω–æ —Ä–∏—Å–æ–≤–∞—Ç—å;
- `drawImage` ‚Äî —Ä–∏—Å—É–µ—Ç –∫–∞—Ä—Ç–∏–Ω–∫—É –∫–∞—Ä—Ç—ã;
- `scale` –∏ `translate` ‚Äî —É–≤–µ–ª–∏—á–∏–≤–∞—é—Ç –∏ –¥–≤–∏–≥–∞—é—Ç –≤—Å—ë, —á—Ç–æ –º—ã —Ä–∏—Å—É–µ–º;
- `drawScene()` ‚Äî –Ω–∞—à–∞ –≥–ª–∞–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è "–Ω–∞—Ä–∏—Å—É–π –≤—Å—ë –∑–∞–Ω–æ–≤–æ".

–°–æ—Ö—Ä–∞–Ω–∏ `map.js`.

---

## 4. –î–µ–ª–∞–µ–º –¥–≤–∏–∂–µ–Ω–∏–µ –∫–∞—Ä—Ç—ã –º—ã—à–∫–æ–π (–ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏–µ)

–¢–µ–ø–µ—Ä—å –Ω–∞—É—á–∏–º –∫–∞—Ä—Ç—É –¥–≤–∏–≥–∞—Ç—å—Å—è, –∫–æ–≥–¥–∞ –º—ã **–∑–∞–∂–∏–º–∞–µ–º –∫–Ω–æ–ø–∫—É –º—ã—à–∏ –∏ —Ç—è–Ω–µ–º**.

–î–æ–±–∞–≤—å –≤ `map.js` **—Å—Ä–∞–∑—É –ø–æ—Å–ª–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö `offsetX`, `offsetY` –∏ –∫–æ–Ω—Å—Ç–∞–Ω—Ç –º–∞—Å—à—Ç–∞–±–∞** —Ç–∞–∫–æ–π –∫–æ–¥:

```javascript
// --- –ü–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏–µ –∫–∞—Ä—Ç—ã –º—ã—à–∫–æ–π ---
let isDragging = false;
let lastMouseX = 0;
let lastMouseY = 0;

canvas.addEventListener('mousedown', (event) => {
  isDragging = true;
  canvas.style.cursor = 'grabbing';
  lastMouseX = event.clientX;
  lastMouseY = event.clientY;
});

canvas.addEventListener('mousemove', (event) => {
  if (!isDragging) return;

  const dx = event.clientX - lastMouseX;
  const dy = event.clientY - lastMouseY;

  offsetX += dx;
  offsetY += dy;

  lastMouseX = event.clientX;
  lastMouseY = event.clientY;

  drawScene();
});

canvas.addEventListener('mouseup', () => {
  isDragging = false;
  canvas.style.cursor = 'grab';
  saveState(); // –±—É–¥–µ–º —Å–æ—Ö—Ä–∞–Ω—è—Ç—å –ø–æ–ª–æ–∂–µ–Ω–∏–µ
});

canvas.addEventListener('mouseleave', () => {
  isDragging = false;
  canvas.style.cursor = 'grab';
});
```

**–ß—Ç–æ —Ç—É—Ç –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:**

- `mousedown` ‚Äî –Ω–∞–∂–∞–ª–∏ –∫–Ω–æ–ø–∫—É –º—ã—à–∏ ‚Üí –Ω–∞—á–∏–Ω–∞–µ–º —Ç—è–Ω—É—Ç—å –∫–∞—Ä—Ç—É;
- `mousemove` ‚Äî –¥–≤–∏–≥–∞–µ–º –º—ã—à—å ‚Üí —Å–º–µ—â–∞–µ–º `offsetX` / `offsetY` –∏ –ø–µ—Ä–µ—Ä–∏—Å–æ–≤—ã–≤–∞–µ–º —Å—Ü–µ–Ω—É;
- `mouseup` –∏–ª–∏ `mouseleave` ‚Äî –æ—Ç–ø—É—Å—Ç–∏–ª–∏ –º—ã—à—å ‚Üí –ø–µ—Ä–µ—Å—Ç–∞—ë–º –¥–≤–∏–≥–∞—Ç—å –∫–∞—Ä—Ç—É.

–°–æ—Ö—Ä–∞–Ω–∏ `map.js` –∏ –ø—Ä–æ–≤–µ—Ä—å –≤ –±—Ä–∞—É–∑–µ—Ä–µ: –∫–∞—Ä—Ç—É —É–∂–µ –º–æ–∂–Ω–æ —Ç–∞—Å–∫–∞—Ç—å!

---

## 5. –î–µ–ª–∞–µ–º –ø—Ä–∏–±–ª–∏–∂–µ–Ω–∏–µ –∏ –æ—Ç–¥–∞–ª–µ–Ω–∏–µ (–∑—É–º –∫–æ–ª–µ—Å–∏–∫–æ–º)

–ú–∞—à–∏–Ω–∞ –∏–¥–µ—è ‚Äî —á—Ç–æ–±—ã –º–æ–∂–Ω–æ –±—ã–ª–æ **–ø—Ä–∏–±–ª–∏–∑–∏—Ç—å –¥–æ —Å–∞–º–æ–≥–æ —Ö–æ–ª–º–∏–∫–∞**. –°–¥–µ–ª–∞–µ–º –∑—É–º –º—ã—à–∏–Ω—ã–º –∫–æ–ª–µ—Å–∏–∫–æ–º.

–í `map.js` –¥–æ–±–∞–≤—å –Ω–∏–∂–µ –±–ª–æ–∫–∞ –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏—è:

```javascript
// --- –ó—É–º –∫–æ–ª–µ—Å–∏–∫–æ–º –º—ã—à–∏ ---
canvas.addEventListener('wheel', (event) => {
  event.preventDefault(); // –æ—Ç–º–µ–Ω—è–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—É—é –ø—Ä–æ–∫—Ä—É—Ç–∫—É —Å—Ç—Ä–∞–Ω–∏—Ü—ã

  const zoomIntensity = 0.1;
  let newScale = scale;

  if (event.deltaY < 0) {
    // –∫–æ–ª–µ—Å–æ –∫—Ä—É—Ç—è—Ç –≤–≤–µ—Ä—Ö ‚Äî —É–≤–µ–ª–∏—á–∏–≤–∞–µ–º
    newScale += zoomIntensity;
  } else {
    // –≤–Ω–∏–∑ ‚Äî —É–º–µ–Ω—å—à–∞–µ–º
    newScale -= zoomIntensity;
  }

  // –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º –∑—É–º
  if (newScale < MIN_SCALE) newScale = MIN_SCALE;
  if (newScale > MAX_SCALE) newScale = MAX_SCALE;

  // –ß—Ç–æ–±—ã –∑—É–º –±—ã–ª "–≤–æ–∫—Ä—É–≥ –º—ã—à–∫–∏", –ø–æ–ø—Ä–∞–≤–∏–º —Å–¥–≤–∏–≥
  const rect = canvas.getBoundingClientRect();
  const mouseX = event.clientX - rect.left;
  const mouseY = event.clientY - rect.top;

  const zoomFactor = newScale / scale;

  offsetX = mouseX - (mouseX - offsetX) * zoomFactor;
  offsetY = mouseY - (mouseY - offsetY) * zoomFactor;

  scale = newScale;
  drawScene();
  saveState();
}, { passive: false });
```

–¢–µ–ø–µ—Ä—å, –∫—Ä—É—Ç—è –∫–æ–ª–µ—Å–æ –º—ã—à–∏ –Ω–∞–¥ –∫–∞—Ä—Ç–æ–π, –º–æ–∂–Ω–æ –ø—Ä–∏–±–ª–∏–∂–∞—Ç—å –∏ –æ—Ç–¥–∞–ª—è—Ç—å –µ—ë.
–ü—Ä–∏ —ç—Ç–æ–º —Ü–µ–Ω—Ç—Ä –∑—É–º–∞ ‚Äî —Ç–∞–º, –≥–¥–µ –∫—É—Ä—Å–æ—Ä.

---

## 6. –ó–∞–¥–∞—ë–º "–º–µ—Å—Ç–∞" –Ω–∞ –∫–∞—Ä—Ç–µ: —Ö–æ–ª–º–∏–∫, —Å–∫–∞–ª–∞, –ø—Ä—É–¥

–¢–µ–ø–µ—Ä—å —Å–¥–µ–ª–∞–µ–º **–æ—Å–æ–±—ã–µ —Ç–æ—á–∫–∏**, –ø–æ –∫–æ—Ç–æ—Ä—ã–º –º–æ–∂–Ω–æ –∫–ª–∏–∫–∞—Ç—å.

–ü—Ä–µ–¥—Å—Ç–∞–≤—å, —á—Ç–æ –∫–∞—Ä—Ç–∞ ‚Äî —ç—Ç–æ –±–æ–ª—å—à–æ–π —Ä–∏—Å—É–Ω–æ–∫, –∞ –º—ã –æ—Ç–º–µ—á–∞–µ–º –Ω–∞ –Ω—ë–º:
- **—Ö–æ–ª–º–∏–∫**,
- **—Å–∫–∞–ª—É**,
- **–ø—Ä—É–¥**.

–£ –∫–∞–∂–¥–æ–π —Ç–æ—á–∫–∏ –±—É–¥—É—Ç –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã (x, y) –≤ **–∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞—Ö –∫–∞—Ä—Ç—ã** (–∞ –Ω–µ —ç–∫—Ä–∞–Ω–∞).

### –®–∞–≥ 1: –î–æ–±–∞–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –æ –º–µ—Å—Ç–∞—Ö –∏ –ø–æ–∫–µ–º–æ–Ω–∞—Ö

–í `map.js` **–≤—ã—à–µ —Ñ—É–Ω–∫—Ü–∏–∏ `drawScene()`** –¥–æ–±–∞–≤—å –º–∞—Å—Å–∏–≤ —Å –º–µ—Å—Ç–∞–º–∏:

```javascript
// --- "–ú–µ—Å—Ç–∞" –Ω–∞ –∫–∞—Ä—Ç–µ –∏ –ø–æ–∫–µ–º–æ–Ω—ã ---
// –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –≤ —Å–∏—Å—Ç–µ–º–µ –∫–∞—Ä—Ç—ã (–∫–∞–∫ –±—É–¥—Ç–æ –∫–∞—Ä—Ç–∞ –Ω–∞—Ä–∏—Å–æ–≤–∞–Ω–∞ –æ—Ç (0,0))
const spots = [
  {
    id: 'hill',
    x: 400,
    y: 300,
    radius: 40,
    pokemon: 'pikachu',
    visible: false
  },
  {
    id: 'rock',
    x: 700,
    y: 450,
    radius: 40,
    pokemon: 'charmander',
    visible: false
  },
  {
    id: 'pond',
    x: 250,
    y: 600,
    radius: 50,
    pokemon: 'squirtle',
    visible: false
  }
];
```

–ó–¥–µ—Å—å:
- `x`, `y` ‚Äî –ø—Ä–∏–º–µ—Ä–Ω—ã–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –º–µ—Å—Ç–∞ –Ω–∞ –∫–∞—Ä—Ç–µ;
- `radius` ‚Äî –Ω–∞—Å–∫–æ–ª—å–∫–æ "–±–æ–ª—å—à–∞—è" –æ–±–ª–∞—Å—Ç—å –∫–ª–∏–∫–∞ –≤–æ–∫—Ä—É–≥ —Ç–æ—á–∫–∏;
- `pokemon` ‚Äî –∏–º—è –ø–æ–∫–µ–º–æ–Ω–∞;
- `visible` ‚Äî –≤–∏–¥–µ–Ω –ª–∏ –ø–æ–∫–µ–º–æ–Ω —Å–µ–π—á–∞—Å.

### –®–∞–≥ 2: –ó–∞–≥—Ä—É–∂–∞–µ–º –∫–∞—Ä—Ç–∏–Ω–∫–∏ –ø–æ–∫–µ–º–æ–Ω–æ–≤

–î–æ–±–∞–≤–∏–º –∏–∫–æ–Ω–∫–∏ –ø–æ–∫–µ–º–æ–Ω–æ–≤. –í –Ω–∞—á–∞–ª–µ —Ñ–∞–π–ª–∞, —Ä—è–¥–æ–º —Å `mapImage`, –¥–æ–±–∞–≤—å:

```javascript
const pokemonImages = {
  pikachu: new Image(),
  charmander: new Image(),
  squirtle: new Image()
};

pokemonImages.pikachu.src = 'images/pikachu-icon.png';
pokemonImages.charmander.src = 'images/charmander-icon.png';
pokemonImages.squirtle.src = 'images/squirtle-icon.png';
```

–ù–µ –∑–∞–±—É–¥—å **–¥–æ–±–∞–≤–∏—Ç—å —Ñ–∞–π–ª—ã –∏–∫–æ–Ω–æ–∫ –≤ –ø–∞–ø–∫—É `images`** (–∫–∞–∫ –≤ –ø—Ä–æ—à–ª–æ–º —É—Ä–æ–∫–µ —Å –º–∞—Ä–∫–µ—Ä–∞–º–∏).

### –®–∞–≥ 3: –†–∏—Å—É–µ–º –ø–æ–∫–µ–º–æ–Ω–æ–≤ –≤ `drawScene()`

–¢–µ–ø–µ—Ä—å –æ–±–Ω–æ–≤–∏–º —Ñ—É–Ω–∫—Ü–∏—é `drawScene()`, —á—Ç–æ–±—ã –æ–Ω–∞ —Ä–∏—Å–æ–≤–∞–ª–∞ –Ω–µ —Ç–æ–ª—å–∫–æ –∫–∞—Ä—Ç—É, –Ω–æ –∏ –ø–æ–∫–µ–º–æ–Ω–æ–≤.

–ù–∞–π–¥–∏ –≤–Ω—É—Ç—Ä–∏ `drawScene()` –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π:

```javascript
  // –ó–¥–µ—Å—å –ø–æ–∑–∂–µ –±—É–¥–µ–º —Ä–∏—Å–æ–≤–∞—Ç—å –ø–æ–∫–µ–º–æ–Ω–æ–≤
```

–ò –∑–∞–º–µ–Ω–∏ –µ–≥–æ –Ω–∞ –∫–æ–¥:

```javascript
  // –†–∏—Å—É–µ–º –ø–æ–∫–µ–º–æ–Ω–æ–≤ –≤ —Ç–µ—Ö –º–µ—Å—Ç–∞—Ö, –≥–¥–µ –æ–Ω–∏ "–≤–∏–¥–∏–º—ã"
  spots.forEach(spot => {
    if (!spot.visible) return;

    const img = pokemonImages[spot.pokemon];
    if (!img.complete) return; // –∫–∞—Ä—Ç–∏–Ω–∫–∞ –µ—â—ë –Ω–µ –∑–∞–≥—Ä—É–∑–∏–ª–∞—Å—å

    const size = 64; // —Ä–∞–∑–º–µ—Ä –∏–∫–æ–Ω–∫–∏
    const half = size / 2;

    ctx.drawImage(img, spot.x - half, spot.y - half, size, size);
  });
```

–¢–µ–ø–µ—Ä—å, –µ—Å–ª–∏ —É –∫–∞–∫–æ–≥–æ‚Äë—Ç–æ `spot.visible = true`, –ø–æ–∫–µ–º–æ–Ω –Ω–∞—Ä–∏—Å—É–µ—Ç—Å—è –Ω–∞ –∫–∞—Ä—Ç–µ.

---

## 7. –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –∫–ª–∏–∫–∏ –ø–æ –∫–∞—Ä—Ç–µ: –ø–æ—è–≤–ª–µ–Ω–∏–µ –∏ –∏—Å—á–µ–∑–Ω–æ–≤–µ–Ω–∏–µ –ø–æ–∫–µ–º–æ–Ω–∞

–ù–∞–º –Ω—É–∂–Ω–æ, —á—Ç–æ–±—ã:

- –ø–µ—Ä–≤—ã–π –∫–ª–∏–∫ –ø–æ —Ö–æ–ª–º–∏–∫—É/—Å–∫–∞–ª–µ/–ø—Ä—É–¥—É ‚Äî **–≤–∫–ª—é—á–∞–ª** –ø–æ–∫–µ–º–æ–Ω–∞;
- –≤—Ç–æ—Ä–æ–π –∫–ª–∏–∫ –ø–æ —ç—Ç–æ–º—É –∂–µ –º–µ—Å—Ç—É ‚Äî **–≤—ã–∫–ª—é—á–∞–ª**.

### –®–∞–≥ 1: –ü–µ—Ä–µ–≤–æ–¥–∏–º –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –∫–ª–∏–∫–∞ –≤ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –∫–∞—Ä—Ç—ã

–ù–∞ —ç–∫—Ä–∞–Ω–µ –º—ã—à—å –¥–∞—ë—Ç –Ω–∞–º **–∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –æ–∫–Ω–∞** (–ø–∏–∫—Å–µ–ª–∏ —ç–∫—Ä–∞–Ω–∞).
–ù–∞–º –Ω—É–∂–Ω–æ –ø–µ—Ä–µ–≤–µ—Å—Ç–∏ –∏—Ö –≤ **–∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –∫–∞—Ä—Ç—ã** —Å —É—á—ë—Ç–æ–º `scale` –∏ `offsetX/Y`.

–î–æ–±–∞–≤—å –≤ `map.js` —Ñ—É–Ω–∫—Ü–∏—é (–≥–¥–µ‚Äë–Ω–∏–±—É–¥—å –ø–æ–¥ `drawScene()`):

```javascript
// –ü–µ—Ä–µ–≤–æ–¥–∏—Ç –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –º—ã—à–∏ –≤ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –∫–∞—Ä—Ç—ã
function screenToMap(x, y) {
  const rect = canvas.getBoundingClientRect();
  const screenX = x - rect.left;
  const screenY = y - rect.top;

  // –û–±—Ä–∞—Ç–Ω–æ–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ translate + scale
  const mapX = (screenX - offsetX) / scale;
  const mapY = (screenY - offsetY) / scale;

  return { x: mapX, y: mapY };
}
```

### –®–∞–≥ 2: –†–µ–∞–≥–∏—Ä—É–µ–º –Ω–∞ –∫–ª–∏–∫–∏ –ø–æ —Ö–æ–ª—Å—Ç—É

–¢–µ–ø–µ—Ä—å –¥–æ–±–∞–≤–∏–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∏–∫–∞ –ø–æ canvas. –í–Ω–∏–∑—É —Ñ–∞–π–ª–∞ (–Ω–æ –¥–æ `saveState()/loadState`, –µ—Å–ª–∏ –æ–Ω–∏ —É–∂–µ –µ—Å—Ç—å) –¥–æ–±–∞–≤—å:

```javascript
// --- –ö–ª–∏–∫ –ø–æ –∫–∞—Ä—Ç–µ ---
canvas.addEventListener('click', (event) => {
  // –ï—Å–ª–∏ —Å–µ–π—á–∞—Å —Ç–∞—â–∏–º –∫–∞—Ä—Ç—É ‚Äî –Ω–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –∫–∞–∫ –∫–ª–∏–∫ –ø–æ –º–µ—Å—Ç—É
  if (isDragging) return;

  const mapPoint = screenToMap(event.clientX, event.clientY);

  // –ò—â–µ–º, –ø–æ–ø–∞–ª–∏ –ª–∏ –º—ã –≤ –∫–∞–∫–æ–µ‚Äë–Ω–∏–±—É–¥—å "–º–µ—Å—Ç–æ"
  let changed = false;

  spots.forEach(spot => {
    const dx = mapPoint.x - spot.x;
    const dy = mapPoint.y - spot.y;
    const distance = Math.sqrt(dx * dx + dy * dy);

    if (distance <= spot.radius) {
      // –ö–ª–∏–∫–Ω—É–ª–∏ –ø–æ —ç—Ç–æ–º—É –º–µ—Å—Ç—É ‚Äî –ø–µ—Ä–µ–∫–ª—é—á–∞–µ–º –≤–∏–¥–∏–º–æ—Å—Ç—å –ø–æ–∫–µ–º–æ–Ω–∞
      spot.visible = !spot.visible;
      changed = true;
    }
  });

  if (changed) {
    drawScene();
    saveState();
  }
});
```

–¢–µ–ø–µ—Ä—å –ª–æ–≥–∏–∫–∞ —Ç–∞–∫–∞—è:

- –∫–ª–∏–∫ ‚Üí –ø–µ—Ä–µ–≤–æ–¥–∏–º –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –≤ —Å–∏—Å—Ç–µ–º—É –∫–∞—Ä—Ç—ã;
- –ø—Ä–æ–≤–µ—Ä—è–µ–º —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –¥–æ –∫–∞–∂–¥–æ–≥–æ `spot`;
- –µ—Å–ª–∏ –ø–æ–ø–∞–ª–∏ –≤ –∫—Ä—É–≥ `radius`, –ø–µ—Ä–µ–∫–ª—é—á–∞–µ–º `visible`;
- –ø–µ—Ä–µ—Ä–∏—Å–æ–≤—ã–≤–∞–µ–º —Å—Ü–µ–Ω—É –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ.

---

## 8. –ó–∞–ø–æ–º–∏–Ω–∞–µ–º –≤—Å—ë –≤ `localStorage`

–ü–æ —É—Å–ª–æ–≤–∏—é –ú–∞—à–∏: *¬´–ü—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –≤—Å–µ –ø–æ–∫–µ–º–æ–Ω—ã –∏ –ø—Ä–∏–±–ª–∏–∂–µ–Ω–∏–µ –æ—Å—Ç–∞—é—Ç—Å—è –Ω–∞ –º–µ—Å—Ç–µ¬ª.*
–≠—Ç–æ –∑–Ω–∞—á–∏—Ç, –º—ã –±—É–¥–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å **localStorage** (–∫–∞–∫ –≤ —É—Ä–æ–∫–µ —Å –ü–æ–∫–µ–¥–µ–∫—Å–æ–º).

### –®–∞–≥ 1: –§—É–Ω–∫—Ü–∏—è `saveState()`

–î–æ–±–∞–≤—å –≤ `map.js` —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∏ –∑–∞–≥—Ä—É–∑–∫–∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è. –ù–∞–ø—Ä–∏–º–µ—Ä, –≤–Ω–∏–∑—É —Ñ–∞–π–ª–∞:

```javascript
// --- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏ –∑–∞–≥—Ä—É–∑–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è –∫–∞—Ä—Ç—ã ---

function saveState() {
  const state = {
    scale: scale,
    offsetX: offsetX,
    offsetY: offsetY,
    spots: spots.map(spot => ({
      id: spot.id,
      visible: spot.visible
    }))
  };

  localStorage.setItem('pokemonMapState', JSON.stringify(state));
}

function loadState() {
  const stateText = localStorage.getItem('pokemonMapState');
  if (!stateText) return;

  try {
    const state = JSON.parse(stateText);

    if (typeof state.scale === 'number') scale = state.scale;
    if (typeof state.offsetX === 'number') offsetX = state.offsetX;
    if (typeof state.offsetY === 'number') offsetY = state.offsetY;

    if (Array.isArray(state.spots)) {
      state.spots.forEach(savedSpot => {
        const spot = spots.find(s => s.id === savedSpot.id);
        if (spot) {
          spot.visible = !!savedSpot.visible;
        }
      });
    }
  } catch (e) {
    console.warn('–ù–µ —É–¥–∞–ª–æ—Å—å –ø—Ä–æ—á–∏—Ç–∞—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∫–∞—Ä—Ç—ã:', e);
  }
}
```

### –®–∞–≥ 2: –ó–∞–≥—Ä—É–∂–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ

–¢–µ–ø–µ—Ä—å –Ω—É–∂–Ω–æ –≤—ã–∑–≤–∞—Ç—å `loadState()` –∏ `drawScene()` –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ –∫–∞—Ä—Ç—ã.

–ù–∞–π–¥–∏ –≤–≤–µ—Ä—Ö—É —Ñ–∞–π–ª–∞ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ `mapImage.onload = function () { ... }` –∏ –≤–Ω—É—Ç—Ä–∏ –Ω–µ–≥–æ –∑–∞–º–µ–Ω–∏ –Ω–∞:

```javascript
mapImage.onload = function () {
  loadState();   // —Å–Ω–∞—á–∞–ª–∞ –∑–∞–≥—Ä—É–∑–∏–º —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
  drawScene();   // –ø–æ—Ç–æ–º –Ω–∞—Ä–∏—Å—É–µ–º –∫–∞—Ä—Ç—É —Å —É—á—ë—Ç–æ–º –º–∞—Å—à—Ç–∞–±–∞/–ø–æ–∫–µ–º–æ–Ω–æ–≤
};
```

–¢–∞–∫–∂–µ –º—ã —É–∂–µ **–≤—ã–∑—ã–≤–∞–µ–º `saveState()`** –ø–æ—Å–ª–µ –∑—É–º–∞ –∏ –ø–æ—Å–ª–µ –æ—Ç–ø—É—Å–∫–∞–Ω–∏—è –∫–∞—Ä—Ç—ã ‚Äî —ç—Ç–æ —Ö–æ—Ä–æ—à–æ.

–¢–µ–ø–µ—Ä—å:
- –ø–æ–π–º–∞–π –ø–æ–∫–µ–º–æ–Ω–æ–≤,
- –ø–æ–¥–≤–∏–≥–∞–π/–ø—Ä–∏–±–ª–∏–∑—å –∫–∞—Ä—Ç—É,
- **–æ–±–Ω–æ–≤–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—É** ‚Äî –≤—Å—ë –¥–æ–ª–∂–Ω–æ –æ—Å—Ç–∞—Ç—å—Å—è –Ω–∞ –º–µ—Å—Ç–µ.

---

## 9. –ú–∏–Ω–∏-–ø—Ä–æ–≤–µ—Ä–∫–∞

–ü—Ä–æ–±–µ–≥–∏ –ø–æ —á–µ–∫‚Äë–ª–∏—Å—Ç—É:

- [ ] –ö–∞—Ä—Ç–∞ —Ä–∏—Å—É–µ—Ç—Å—è –Ω–∞ —Ö–æ–ª—Å—Ç–µ (`canvas`), –∞ –Ω–µ –ø—Ä–æ—Å—Ç–æ –∫–∞–∫ `<img>`.
- [ ] –ö–∞—Ä—Ç—É –º–æ–∂–Ω–æ –¥–≤–∏–≥–∞—Ç—å –º—ã—à–∫–æ–π (–∑–∞–∂–∏–º–∞—è –ª–µ–≤—É—é –∫–Ω–æ–ø–∫—É).
- [ ] –ö–∞—Ä—Ç—É –º–æ–∂–Ω–æ –ø—Ä–∏–±–ª–∏–∂–∞—Ç—å –∏ –æ—Ç–¥–∞–ª—è—Ç—å –∫–æ–ª–µ—Å–æ–º –º—ã—à–∏.
- [ ] –ï—Å—Ç—å –º–∏–Ω–∏–º—É–º —Ç—Ä–∏ "–º–µ—Å—Ç–∞" (—Ö–æ–ª–º–∏–∫, —Å–∫–∞–ª–∞, –ø—Ä—É–¥).
- [ ] –ü—Ä–∏ –∫–ª–∏–∫–µ –ø–æ –º–µ—Å—Ç—É –ø–æ—è–≤–ª—è–µ—Ç—Å—è –ø–æ–∫–µ–º–æ–Ω.
- [ ] –ü—Ä–∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–º –∫–ª–∏–∫–µ –ø–æ —ç—Ç–æ–º—É –∂–µ –º–µ—Å—Ç—É –ø–æ–∫–µ–º–æ–Ω –∏—Å—á–µ–∑–∞–µ—Ç.
- [ ] –ü–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã –ø–æ–∫–µ–º–æ–Ω—ã –∏ –ø–æ–ª–æ–∂–µ–Ω–∏–µ –∫–∞—Ä—Ç—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è.

–ï—Å–ª–∏ —á—Ç–æ‚Äë—Ç–æ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç ‚Äî –ø—Ä–æ–≤–µ—Ä—å –ø–æ —à–∞–≥–∞–º –∏ –ø–æ–ø—Ä–æ—Å–∏ –ø–∞–ø—É –ø–æ–º–æ—á—å –Ω–∞–π—Ç–∏ –æ–ø–µ—á–∞—Ç–∫—É. –≠—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–∞—è —á–∞—Å—Ç—å –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è üôÇ

---

## 10. –°–ª–æ–≤–∞—Ä–∏–∫ –ø—Ä–æ—Å—Ç—ã—Ö —Ç–µ—Ä–º–∏–Ω–æ–≤

- **Canvas (—Ö–æ–ª—Å—Ç)** ‚Äî –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ, –Ω–∞ –∫–æ—Ç–æ—Ä–æ–º –º—ã –º–æ–∂–µ–º —Ä–∏—Å–æ–≤–∞—Ç—å —á–µ—Ä–µ–∑ JavaScript.
- **–ö–æ–Ω—Ç–µ–∫—Å—Ç (`getContext('2d')`)** ‚Äî "–∫–∏—Å—Ç—å" –¥–ª—è —Ä–∏—Å–æ–≤–∞–Ω–∏—è –Ω–∞ —Ö–æ–ª—Å—Ç–µ.
- **–ú–∞—Å—à—Ç–∞–± (`scale`)** ‚Äî –≤–æ —Å–∫–æ–ª—å–∫–æ —Ä–∞–∑ —É–≤–µ–ª–∏—á–µ–Ω–∞ –∏–ª–∏ —É–º–µ–Ω—å—à–µ–Ω–∞ –∫–∞—Ä—Ç–∏–Ω–∫–∞.
- **–°–¥–≤–∏–≥ (`offsetX`, `offsetY`)** ‚Äî –Ω–∞—Å–∫–æ–ª—å–∫–æ –∫–∞—Ä—Ç–∞ —Å–¥–≤–∏–Ω—É—Ç–∞ –æ—Ç –Ω–∞—á–∞–ª–∞ —Ö–æ–ª—Å—Ç–∞.
- **–ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã** ‚Äî –ø–∞—Ä–∞ —á–∏—Å–µ–ª `(x, y)`, –∫–æ—Ç–æ—Ä—ã–µ –≥–æ–≤–æ—Ä—è—Ç, –≥–¥–µ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è —Ç–æ—á–∫–∞.
- **–°–æ–±—ã—Ç–∏–µ –º—ã—à–∏** ‚Äî –¥–µ–π—Å—Ç–≤–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è: `mousedown`, `mousemove`, `mouseup`, `click`, `wheel`.
- **localStorage** ‚Äî "–∫–∞—Ä–º–∞—à–µ–∫" –≤ –±—Ä–∞—É–∑–µ—Ä–µ, –≥–¥–µ –º–æ–∂–Ω–æ —Ö—Ä–∞–Ω–∏—Ç—å —Ç–µ–∫—Å—Ç –º–µ–∂–¥—É –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞–º–∏.
- **JSON** ‚Äî —Å–ø–æ—Å–æ–± –ø—Ä–µ–≤—Ä–∞—Ç–∏—Ç—å –æ–±—ä–µ–∫—Ç –≤ —Å—Ç—Ä–æ–∫—É (`JSON.stringify`) –∏ –æ–±—Ä–∞—Ç–Ω–æ (`JSON.parse`).

---

## –ò—Ç–æ–≥

–¢–µ–ø–µ—Ä—å —É —Ç–µ–±—è –Ω–µ –ø—Ä–æ—Å—Ç–æ –∫–∞—Ä—Ç–∏–Ω–∫–∞, –∞ **–∂–∏–≤–∞—è –∫–∞—Ä—Ç–∞ –ø–æ–∫–µ–º–æ–Ω—Å–∫–æ–≥–æ –º–∏—Ä–∞**:

- –º–æ–∂–Ω–æ "–ª–µ—Ç–∞—Ç—å" –Ω–∞–¥ –º–∏—Ä–æ–º, –ø—Ä–∏–±–ª–∏–∂–∞—Ç—å—Å—è –∫ –º–∞–ª–µ–Ω—å–∫–∏–º –¥–µ—Ç–∞–ª—è–º;
- –º–æ–∂–Ω–æ "–ø—Ä–∏–∑—ã–≤–∞—Ç—å" –ø–æ–∫–µ–º–æ–Ω–æ–≤ –Ω–∞ —Ö–æ–ª–º–∏–∫, —Å–∫–∞–ª—É –∏–ª–∏ –ø—Ä—É–¥;
- –∫–∞—Ä—Ç–∞ –ø–æ–º–Ω–∏—Ç —Ç–≤–æ–∏ –¥–µ–π—Å—Ç–≤–∏—è.

–î–∞–ª—å—à–µ –º–æ–∂–Ω–æ –ø—Ä–∏–¥—É–º—ã–≤–∞—Ç—å —É—Ä–æ–≤–Ω–∏, –∑–∞–¥–∞–Ω–∏—è ("–Ω–∞–π–¥–∏ –≤—Å–µ—Ö –≤–æ–¥–Ω—ã—Ö –ø–æ–∫–µ–º–æ–Ω–æ–≤"), –∫–≤–µ—Å—Ç—ã –∏ –¥–∞–∂–µ –º–∏–Ω–∏‚Äë–∏–≥—Ä—ã –ø–æ–≤–µ—Ä—Ö —ç—Ç–æ–π –∫–∞—Ä—Ç—ã. –ù–æ —ç—Ç–æ —É–∂–µ –∏—Å—Ç–æ—Ä–∏—è –¥–ª—è —Å–ª–µ–¥—É—é—â–∏—Ö —É—Ä–æ–∫–æ–≤‚Ä¶
